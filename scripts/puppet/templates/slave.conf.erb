
#!upstart
 
# Location: /etc/init/app.conf
# Debugging: $ sudo stop app.conf; sudo start app.conf
 
description "app"
author      "pryv"
 
start on (local-filesystems and net-device-up IFACE=eth0) 
stop  on shutdown
 
respawn # restart when job dies
 
script
exec sudo -u root NODE_ENV=production /usr/local/bin/supervisor -w /var/www/<%= app %> --  /var/www/<%= app %>/source/app-dns.js --config /var/www/<%= app %>/source/config.json >> /var/log/app.log 2>&1
end script
 
pre-start script                             
  echo "[`date -u +%Y-%m-%dT%T.%3NZ`] Starting" >> /var/log/app.log 
end script 
 
post-stop script 
  echo "[`date -u +%Y-%m-%dT%T.%3NZ`] Stopping" >> /var/log/app.log 
end script 
